<link rel="stylesheet" href="css/notifications/sxn-notifications.v2.min.css" />
<script>
$( document ).ready(function() {
  var today = $('#today');
  var week = $('#week');
  var month = $('#month');
  var past = $('#past');
  var header = "";
  var notifications = "";
  var current = new Date();
  var begofWeek = current.getDate() - current.getDay();
  var currentDay = current.getDate();
  var currentMonth = current.getMonth();
  var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  currentMonth = months[currentMonth];
  var currentDate = currentMonth + ' ' + currentDay + ', ' + current.getFullYear();
  var previousDate = currentMonth + ' ' + currentDay + ', ' + current.getFullYear();
  var addedHeader = false;
  {{#each notifications}}
  var date = '{{createdAt}}';
  var dateArray = date.split(/[ ,]+/);
  date = dateArray[0] + ' ' + dateArray[1] + ', ' + dateArray[2];
  if(date==currentDate && addedHeader==false) {
    header = '<h4 class="today">TODAY</h4>';
    notifications += header;
    addedHeader = true;
  } else if(dateArray[0] == currentMonth && dateArray[1]==currentDay-1 && addedHeader==false) {
    header = '<h4 class="today">YESTERDAY</h4>';
    notifications += header;
    addedHeader = true;
  } else if(addedHeader==false){
    header = '<h4 class="today">{{date}}</h4>';
    notifications += header;
    addedHeader = true;
  }
  if(previousDate==date) {
    notifications += '<div class="uk-card uk-card-default uk-card-body"><div class="main-post"><div class="poster-avi uk-float-left"><img src="img/user.png" alt="Alex Reekie" /></div><div class="poster-info uk-float-left"><span class="name"><a {{#compare this.routeID.kind 'Group' operator="=="}}href="/groups/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Post' operator="=="}}href="/post/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Event' operator="=="}}href="/event/{{this.routeID.item}}"{{/compare}}>{{this.type}}</a></span><span class="timestamp">{{this.createdAt}}</span><br /><span>{{this.message}}</span></div></div></div>';
    if({{../notifications.length}}=={{@index}}+1) {
      notifications+= '</div>';
      if(date == currentDate) {
        today.append(notifications);
      } else if(dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] > begofWeek) {
        week.append(notifications);
      } else if(dateArray[0] == currentMonth) {
        month.append(notifications);
      } else {
        past.append(notifications);
      }
    }
  } else {
    if(previousDate == currentDate) {
      notifications += '</div>';
      today.append(notifications);
      notifications = "";
      previousDate = date;
      addedHeader=false;
      if(dateArray[0] == currentMonth && dateArray[1]==currentDay-1 && addedHeader==false) {
        header = '<h4 class="today">YESTERDAY</h4>';
        notifications += header;
        addedHeader = true;
      } else if(addedHeader==false){
        header = '<h4 class="today">' + date + '</h4>';
        notifications += header;
        addedHeader = true;
      }
      notifications += '<div class="uk-card uk-card-default uk-card-body"><div class="main-post"><div class="poster-avi uk-float-left"><img src="img/user.png" alt="Alex Reekie" /></div><div class="poster-info uk-float-left"><span class="name"><a {{#compare this.routeID.kind 'Group' operator="=="}}href="/groups/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Post' operator="=="}}href="/post/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Event' operator="=="}}href="/event/{{this.routeID.item}}"{{/compare}}>{{this.type}}</a></span><span class="timestamp">{{this.createdAt}}</span><br /><span>{{this.message}}</span></div></div></div>'
      if({{../notifications.length}}=={{@index}}+1) {
        notifications+= '</div>';
        if(date == currentDate) {
          today.append(notifications);
        } else if(dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] >= begofWeek) {
          week.append(notifications);
        } else if(dateArray[0] == currentMonth) {
          month.append(notifications);
        } else {
          past.append(notifications);
        }
      }
    } else if (dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] >= begofWeek) {
      notifications += '</div><br>';
      week.append(notifications);
      notifications = "";
      previousDate = date;
      addedHeader=false;
      if(dateArray[0] == currentMonth && dateArray[1]==currentDay-1 && addedHeader==false) {
        header = '<h4 class="today">YESTERDAY</h4>';
        notifications += header;
        addedHeader = true;
      }
      else if(addedHeader==false){
        header = '<h4 class="today">' + date + '</h4>';
        notifications += header;
        addedHeader = true;
      }
      notifications += '<div class="uk-card uk-card-default uk-card-body"><div class="main-post"><div class="poster-avi uk-float-left"><img src="img/user.png" alt="Alex Reekie" /></div><div class="poster-info uk-float-left"><span class="name"><a {{#compare this.routeID.kind 'Group' operator="=="}}href="/groups/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Post' operator="=="}}href="/post/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Event' operator="=="}}href="/event/{{this.routeID.item}}"{{/compare}}>{{this.type}}</a></span><span class="timestamp">{{this.createdAt}}</span><br /><span>{{this.message}}</span></div></div></div>'
      if({{../notifications.length}}=={{@index}}+1) {
        notifications+= '</div><br>';
        if(date == currentDate) {
          today.append(notifications);
        } else if(dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] >= begofWeek) {
          week.append(notifications);
        } else if(dateArray[0] == currentMonth) {
          month.append(notifications);
        } else {
          past.append(notifications);
        }
      }
    } else if (dateArray[0] == currentMonth) {
      notifications += '</div><br>';
      month.append(notifications);
      notifications = "";
      previousDate = date;
      addedHeader=false;
      if(addedHeader==false){
        header = '<h4 class="today">' + date + '</h4>';
        notifications += header;
        addedHeader = true;
      }
      notifications += '<div class="uk-card uk-card-default uk-card-body"><div class="main-post"><div class="poster-avi uk-float-left"><img src="img/user.png" alt="Alex Reekie" /></div><div class="poster-info uk-float-left"><span class="name"><a {{#compare this.routeID.kind 'Group' operator="=="}}href="/groups/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Post' operator="=="}}href="/post/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Event' operator="=="}}href="/event/{{this.routeID.item}}"{{/compare}}>{{this.type}}</a></span><span class="timestamp">{{this.createdAt}}</span><br /><span>{{this.message}}</span></div></div></div>'
      if({{../notifications.length}}=={{@index}}+1) {
        notifications+= '</div><br>';
        if(date == currentDate) {
          today.append(notifications);
        } else if(dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] >= begofWeek) {
          week.append(notifications);
        } else if(dateArray[0] == currentMonth) {
          month.append(notifications);
        } else {
          past.append(notifications);
        }
      }
    } else {
      notifications += '</div><br>';
      past.append(notifications);
      notifications = "";
      previousDate = date;
      addedHeader=false;
      if(addedHeader==false){
        header = '<h4 class="today">' + date + '</h4>';
        notifications += header;
        addedHeader = true;
      }
      notifications += '<div class="uk-card uk-card-default uk-card-body"><div class="main-post"><div class="poster-avi uk-float-left"><img src="img/user.png" alt="Alex Reekie" /></div><div class="poster-info uk-float-left"><span class="name"><a {{#compare this.routeID.kind 'Group' operator="=="}}href="/groups/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Post' operator="=="}}href="/post/{{this.routeID.item}}"{{/compare}}{{#compare this.routeID.kind 'Event' operator="=="}}href="/event/{{this.routeID.item}}"{{/compare}}>{{this.type}}</a></span><span class="timestamp">{{this.createdAt}}</span><br /><span>{{this.message}}</span></div></div></div>'
      if({{../notifications.length}}=={{@index}}+1) {
        notifications+= '</div><br>';
        if(date == currentDate) {
          today.append(notifications);
        } else if(dateArray[0] == currentMonth && dateArray[1] < currentDay && dateArray[1] >= begofWeek) {
          week.append(notifications);
        } else if(dateArray[0] == currentMonth) {
          month.append(notifications);
        } else {
          past.append(notifications);
        }
      }
    }
  }
  {{/each}}
});
</script>
<div id="notifications">
  <div class="today notifications-item" id="today">
  </div>
  <div class="week notifications-item" id="week">
  </div>
  <div class="month notifications-item" id="month">
  </div>
  <div class="past notifications-item" id="past">
  </div>

</div>
